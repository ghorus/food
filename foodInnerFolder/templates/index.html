{% extends 'layout.html' %}
{% block content %}
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <p class={{category}}>{{message}}</p>
        {% endfor %}
    {% endif %}
{% endwith %}
{% for post in posts %}
<!-- {{post}}
    <p> these people like it {{post.liker|length}}</p> 
    <p> this post has this many likes: {{current_user.likes}}</p>
    {% for like in current_user.likes %}
        {%if like == post %}
        yes!
        {%endif %}
    {% endfor %} -->
    <div class="postContainer">
        <section class="post">
            <div class="postUserPicPaddingContainer">
                <div class="postUserPicContainer">
                    <img class="postUserPic" src="{{url_for('static', filename = 'profile_pics/' + post.author.image_file)}}">
                    <div class="postUserTime">
                        <span>Posted by <a class="postUsername" href="{{url_for('users.user_posts', username=post.author.username)}}">{{post.author.username}}</a></span>
                        <span class="postTime">{{post.datePosted.strftime('%m-%d-%Y @ %H:%M')}}</span>
                        <span class="postTime">{{post.name}}</span>
                        <span class="postTime">{{post.city}}</span>
                    </div>
                </div>
                <div class="postContents">
                    <h1 class="ratingStars">{{post.rating}}</h1>
                    <a href="{{url_for('users.post',post_id=post.id)}}"><h3 class="postTitle" style="display:inline">{{post.title}}</h3></a>
                    <p class="postContent">{{post.content}}</p>
                </div>
            </div>
            <form class="likeContainer" action="{{url_for('main.like',post_id=post.id)}}" method="POST">
                <input class="likeButton" type="image" src="{{url_for('static', filename = 'post_pics/heart.png')}}" alt="Submit"/>{{post.liker|length}} Likes
            </form>
            {% if post.author == current_user %}
                <div class="updateDeleteContainer">
                    <img class="menuPic" src="{{url_for('static', filename = 'post_pics/menu.png')}}">
                    <section class="menuPicItemsContainer">
                        <div class="menuPicItemContainer">
                            <img class="menuPicItem" src="{{url_for('static', filename = 'post_pics/delete.png')}}">
                            <form action="{{url_for('users.delete_post',post_id=post.id)}}" method="POST">
                                <input class="postDeleteButton" type="submit" value="Delete">
                            </form>
                        </div>
                        <a href="{{url_for('users.update_post',post_id=post.id)}}">
                            <div class="menuPicItemContainer">
                                <img class="menuPicItem" src="{{url_for('static', filename = 'post_pics/arrow.png')}}">
                                <span>Update</span>
                            </div>
                        </a>
                    </section>
                </div>
            {% endif %}
            <div class="postFoodPicContainer"><img class="postFoodPic" src="{{url_for('static', filename = 'images/' + post.picture)}}"></div>
        </section>
    </div>
{% endfor %}
{% for page_num in posts.iter_pages(left_edge=1,right_edge=1,left_current=1,right_current=1) %}
    {% if page_num %}
        {% if posts.page == page_num %}
            <a href="{{url_for('main.home',page=page_num)}}" style="font-size:40px;">{{page_num}}</a>
        {% else %}
            <a href="{{url_for('main.home',page=page_num)}}">{{page_num}}</a>
        {% endif %}
    {% else %}
        ...
    {% endif %}
{% endfor %}
{% endblock content %}